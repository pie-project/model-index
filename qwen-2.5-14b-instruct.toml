# Model metadata
name = "qwen-2.5-14b-instruct"
description = "Qwen 2.5 14B Instruct Model"
version = "1.0"
parameters = ["qwen-2.5-14b-instruct.zt"]

# Model architecture details
[architecture]
type = "qwen2"
num_layers = 48
num_query_heads = 40
num_key_value_heads = 8
head_size = 128
hidden_size = 5120
intermediate_size = 13824
vocab_size = 152064
use_qkv_bias = true
rms_norm_eps = 1e-6

[architecture.rope]
theta = 1000000.0

# Tokenizer configuration
[tokenizer]
type = "bpe"
vocabulary_file = "qwen-2.5.vocab"
split_regex = "(?i:[sdmt]|ll|ve|re)|[^\\r\\n\\p{L}\\p{N}]?+\\p{L}++|\\p{N}{1,3}+| ?[^\\s\\p{L}\\p{N}]++[\\r\\n]*+|\\s++$|\\s*[\\r\\n]|\\s+(?!\\S)|\\s"
escape_non_printable = true

[tokenizer.special_tokens]
"<|endoftext|>" = 151643
"<|im_start|>" = 151644
"<|im_end|>" = 151645
"<|object_ref_start|>" = 151646
"<|object_ref_end|>" = 151647
"<|box_start|>" = 151648
"<|box_end|>" = 151649
"<|quad_start|>" = 151650
"<|quad_end|>" = 151651
"<|vision_start|>" = 151652
"<|vision_end|>" = 151653
"<|vision_pad|>" = 151654
"<|image_pad|>" = 151655
"<|video_pad|>" = 151656
"<tool_call>" = 151657
"</tool_call>" = 151658
"<|fim_prefix|>" = 151659
"<|fim_middle|>" = 151660
"<|fim_suffix|>" = 151661
"<|fim_pad|>" = 151662
"<|repo_name|>" = 151663
"<|file_sep|>" = 151664

# Prompt template configuration for instruct model
[template]
type = "minijinja"
content = "{%- if tools %}\n    {{- '<|im_start|>system\\n' }}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- messages[0]['content'] }}\n    {%- else %}\n        {{- 'You are Qwen, created by Alibaba Cloud. You are a helpful assistant.' }}\n    {%- endif %}\n    {{- \"\\n\\n# Tools\\n\\nYou may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within <tools></tools> XML tags:\\n<tools>\" }}\n    {%- for tool in tools %}\n        {{- \"\\n\" }}\n        {{- tool | tojson }}\n    {%- endfor %}\n    {{- \"\\n</tools>\\n\\nFor each function call, return a json object with function name and arguments within <tool_call></tool_call> XML tags:\\n<tool_call>\\n{\\\"name\\\": <function-name>, \\\"arguments\\\": <args-json-object>}\\n</tool_call><|im_end|>\\n\" }}\n{%- else %}\n    {%- if messages[0]['role'] == 'system' %}\n        {{- '<|im_start|>system\\n' + messages[0]['content'] + '<|im_end|>\\n' }}\n    {%- else %}\n        {{- '<|im_start|>system\\nYou are Qwen, created by Alibaba Cloud. You are a helpful assistant.<|im_end|>\\n' }}\n    {%- endif %}\n{%- endif %}\n{%- for message in messages %}\n    {%- if (message.role == \"user\") or (message.role == \"system\" and not loop.first) or (message.role == \"assistant\" and not message.tool_calls) %}\n        {{- '<|im_start|>' + message.role + '\\n' + message.content + '<|im_end|>' + '\\n' }}\n    {%- elif message.role == \"assistant\" %}\n        {{- '<|im_start|>' + message.role }}\n        {%- if message.content %}\n            {{- '\\n' + message.content }}\n        {%- endif %}\n        {%- for tool_call in message.tool_calls %}\n            {%- if tool_call.function is defined %}\n                {%- set tool_call = tool_call.function %}\n            {%- endif %}\n            {{- '\\n<tool_call>\\n{\"name\": \"' }}\n            {{- tool_call.name }}\n            {{- '\", \"arguments\": ' }}\n            {{- tool_call.arguments | tojson }}\n            {{- '}\\n</tool_call>' }}\n        {%- endfor %}\n        {{- '<|im_end|>\\n' }}\n    {%- elif message.role == \"tool\" %}\n        {%- if (loop.index0 == 0) or (messages[loop.index0 - 1].role != \"tool\") %}\n            {{- '<|im_start|>user' }}\n        {%- endif %}\n        {{- '\\n<tool_response>\\n' }}\n        {{- message.content }}\n        {{- '\\n</tool_response>' }}\n        {%- if loop.last or (messages[loop.index0 + 1].role != \"tool\") %}\n            {{- '<|im_end|>\\n' }}\n        {%- endif %}\n    {%- endif %}\n{%- endfor %}\n{%- if add_generation_prompt %}\n    {{- '<|im_start|>assistant\\n' }}\n{%- endif %}\n"
stop_tokens = ["<|im_end|>", "<|endoftext|>"]

[source]
"qwen-2.5-14b-instruct.zt" = "https://huggingface.co/pie-project/qwen-2.5-14b-instruct/resolve/main/qwen-2.5-14b-instruct.zt"
"qwen-2.5.vocab" = "https://huggingface.co/pie-project/qwen-2.5-14b-instruct/resolve/main/qwen-2.5.vocab"
